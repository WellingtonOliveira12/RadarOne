# ============================================
# DATABASE
# ============================================
# Desenvolvimento local:
# DATABASE_URL="postgresql://user:password@localhost:5432/radarone?schema=public"
#
# Produção (Neon):
# DATABASE_URL="postgresql://neondb_owner:********@ep-exemplo.sa-east-1.aws.neon.tech/radarone_prod?sslmode=require"
DATABASE_URL="postgresql://user:password@localhost:5432/radarone?schema=public"

# ============================================
# SERVER
# ============================================
PORT=3000
NODE_ENV=development

# URL pública do backend (usado em produção para webhooks)
# Desenvolvimento: http://localhost:3000
# Produção (Render): https://radarone-api.onrender.com (ou seu domínio customizado)
PUBLIC_URL=http://localhost:3000

# URL base do backend (prioridade para webhook do Telegram)
# Fallback: PUBLIC_URL se não definido
# Desenvolvimento: http://localhost:3000
# Produção: https://api.radarone.com.br
BACKEND_BASE_URL=http://localhost:3000

# IMPORTANTE - PRODUÇÃO:
# Após deploy no Render, atualizar para:
# BACKEND_BASE_URL=https://api.radarone.com.br (se usar domínio customizado)
# PUBLIC_URL=https://api.radarone.com.br (se usar domínio customizado)
# OU
# BACKEND_BASE_URL=https://radarone-api.onrender.com (se usar subdomínio Render)
# PUBLIC_URL=https://radarone-api.onrender.com (se usar subdomínio Render)

# ============================================
# JWT
# ============================================
# IMPORTANTE: Trocar por um valor seguro em produção (mínimo 32 caracteres)
JWT_SECRET=your-super-secret-jwt-key-change-this-in-production
JWT_EXPIRES_IN=7d

# Secret específica para tokens de reset de senha (OBRIGATÓRIO em produção)
# IMPORTANTE: DEVE ser diferente do JWT_SECRET para isolar risco de vazamento
# Em produção, esta secret é OBRIGATÓRIA (não usa mais fallback para JWT_SECRET)
# Gere com: openssl rand -base64 32
PASSWORD_RESET_SECRET=your-password-reset-secret-here

# ============================================
# AUTH SECURITY
# ============================================
# Revelar se email não existe em forgot-password (DEV vs PROD)
# DEV: true (melhor UX - usuário sabe se errou o email)
# PROD: false ou não definido (segurança - não revela usuários cadastrados)
# IMPORTANTE: Em produção, deixar false para evitar enumeração de usuários
REVEAL_EMAIL_NOT_FOUND=true

# ============================================
# KIWIFY INTEGRATION
# ============================================
KIWIFY_API_KEY=your-kiwify-api-key

# IMPORTANTE: Secret usado para validar webhooks (HMAC SHA256)
# Este valor DEVE ser o mesmo configurado no painel da Kiwify
# Produção: OBRIGATÓRIO (rejeita webhooks sem validação)
# Desenvolvimento: OPCIONAL (aceita sem validação se não configurado)
KIWIFY_WEBHOOK_SECRET=your-kiwify-webhook-secret

KIWIFY_BASE_URL=https://api.kiwify.com.br

# ============================================
# TELEGRAM
# ============================================
# Token do bot (obter via @BotFather no Telegram)
TELEGRAM_BOT_TOKEN=your-telegram-bot-token

# Username do bot (sem @)
TELEGRAM_BOT_USERNAME=RadarOneBot

# Segredo para validar webhook (gere string aleatória forte)
# Para gerar: openssl rand -hex 32
TELEGRAM_WEBHOOK_SECRET=your-telegram-webhook-secret-change-in-production

# ============================================
# EMAIL SERVICE (Resend) - OBRIGATÓRIO
# ============================================
# Criar conta gratuita em: https://resend.com/signup
# Pegar API key em: https://resend.com/api-keys
# Plano gratuito: 100 emails/dia, 3.000 emails/mês
RESEND_API_KEY=re_your_resend_api_key_here

# Email remetente (deve estar verificado no Resend)
# Para domínio custom: contato@radarone.com.br
EMAIL_FROM=contato@radarone.com.br
EMAIL_FROM_NAME=RadarOne
EMAIL_REPLY_TO=contato@radarone.com.br

# Email para receber notificações administrativas (jobs, relatórios, etc.)
# Se não configurado, usa EMAIL_REPLY_TO como fallback
ADMIN_EMAIL=admin@radarone.com.br

# ============================================
# CORS
# ============================================
# URL do frontend (usado para links em emails e domínio customizado)
# Desenvolvimento:
FRONTEND_URL=http://localhost:5173

# IMPORTANTE - PRODUÇÃO:
# Após deploy do frontend, atualizar para:
# FRONTEND_URL=https://radarone.com.br (domínio customizado)
# OU
# FRONTEND_URL=https://radarone-frontend.onrender.com (subdomínio Render)
#
# APP_BASE_URL também pode ser definido (padrão: FRONTEND_URL)
APP_BASE_URL=https://radarone.com.br
#
# NOTA: CORS está configurado para aceitar automaticamente:
#   - https://radarone.com.br (domínio custom)
#   - https://www.radarone.com.br (domínio custom com www)
#   - https://radarone-frontend.onrender.com (produção)
#   - http://localhost:5173 (dev)
#   - http://localhost (dev/Docker)
#   - Valor de FRONTEND_URL (domínio customizado)

# ============================================
# SESSION ENCRYPTION (REQUIRED for user sessions)
# ============================================
# Key used to encrypt/decrypt user authentication sessions (Facebook, ML, etc.)
# MUST be the same value in both backend AND worker environments
# Generate with: node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
# Minimum: 32 characters
SESSION_ENCRYPTION_KEY=

# ============================================
# CRYPTO
# ============================================
# IMPORTANTE: Chave de 64 caracteres hexadecimais (32 bytes)
# Para gerar uma chave segura, use: openssl rand -hex 32
# NUNCA compartilhe ou comite esta chave no Git!
# LGPD: Usada para encriptar CPF dos usuários com AES-256-GCM
CPF_ENCRYPTION_KEY=0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef

# ============================================
# CUPONS - VITALICIO (Allowlist)
# ============================================
# Lista de emails autorizados a usar o cupom VITALICIO (separados por vírgula)
# Exemplo: VITALICIO_ALLOWED_EMAILS=wellington@example.com,kristiann@example.com
VITALICIO_ALLOWED_EMAILS=

# ============================================
# SENTRY (Monitoramento de Erros) - OPCIONAL
# ============================================
# DSN do Sentry para captura de exceções em produção
# Criar conta gratuita em: https://sentry.io/signup/
# Se não configurado, o Sentry não será ativado
# SENTRY_DSN=

# ============================================
# APPLICATION CONFIG (all optional, sensible defaults)
# ============================================

# Auth Token Lifetimes
# ACCESS_TOKEN_EXPIRES_IN=15m
# TWO_FACTOR_TOKEN_EXPIRES_IN=5m
# PASSWORD_RESET_TOKEN_EXPIRES_IN=30m
# REFRESH_TOKEN_EXPIRY_DAYS=7
# MAX_TOKENS_PER_USER=5
# REVOKED_TOKEN_CLEANUP_DAYS=30

# Job Scheduler (cron expressions)
# WARMUP_PING_CRON=*/10 * * * *
# CHECK_TRIAL_EXPIRING_CRON=0 9 * * *
# CHECK_SUBSCRIPTION_EXPIRED_CRON=0 10 * * *
# RESET_MONTHLY_QUERIES_CRON=0 3 1 * *
# CHECK_COUPON_ALERTS_CRON=0 11 * * *
# CHECK_TRIAL_UPGRADE_EXPIRING_CRON=0 12 * * *
# CHECK_ABANDONED_COUPONS_CRON=0 13 * * *
# CHECK_SESSION_EXPIRING_CRON=0 14 * * *
# SCHEDULER_TIMEZONE=America/Sao_Paulo

# Plan Defaults
# FALLBACK_TRIAL_DAYS=7
# DEFAULT_MAX_MONITORS=1
# DEFAULT_MAX_SITES=1
# DEFAULT_MAX_ALERTS_PER_DAY=3

# Notification Thresholds
# TRIAL_WARNING_DAYS_BEFORE=3
# ABANDONED_COUPON_FIRST_REMINDER_HOURS=24
# ABANDONED_COUPON_SECOND_REMINDER_HOURS=48
# SESSION_EXPIRING_WARNING_DAYS=3

# HTTP Timeouts
# TELEGRAM_REQUEST_TIMEOUT_MS=10000
# HEALTH_CHECK_TIMEOUT_MS=10000
